- name: 'Electricity Max Peak (Daily)'
  unique_id: electricity_delivery_power_daily_15m_max
  unit_of_measurement: 'kW'
  icon: >
    mdi:transmission-tower
  state: >
    {% if is_number(states('sensor.electricity_delivery_power_daily_15m_max')) %}
      {% if ((now().hour == 0) and (now().minute < 15)) %}
        {{ states('sensor.electricity_delivery_power_15m') | float }}
      {% else %}
        {% if ((states('sensor.electricity_delivery_power_daily_15m_max') | float) < (states('sensor.electricity_delivery_power_15m')) | float) %}
          {{ states('sensor.electricity_delivery_power_15m') or 0 | float }}
        {% else %}
          {{ states('sensor.electricity_delivery_power_daily_15m_max') | float }}
        {% endif %}
      {% endif %}
    {% else %}
      0
    {% endif %}

- name: 'Electricity Max Peak (Monthly)'
  unique_id: electricity_delivery_power_monthly_15m_max
  unit_of_measurement: 'kW'
  icon: >
    mdi:transmission-tower
  state: >
    {% if is_number(states('sensor.electricity_delivery_power_monthly_15m_max')) %}
      {% if ((now().day == 1) and (now().hour == 0) and (now().minute < 15)) %}
        {{ states('sensor.electricity_delivery_power_15m') | float }}
      {% else %}
        {% if ((states('sensor.electricity_delivery_power_monthly_15m_max') | float) < (states('sensor.electricity_delivery_power_15m')) | float) %}
          {{ states('sensor.electricity_delivery_power_15m') or 0 | float }}
        {% else %}
          {{ states('sensor.electricity_delivery_power_monthly_15m_max') | float }}
        {% endif %}
      {% endif %}
    {% else %}
      0
    {% endif %}
